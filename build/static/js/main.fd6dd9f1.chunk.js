(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{85:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var s=n(26),a=n(43),i=n(44),c=n(48),o=n(47),r=n(21),l=n.n(r),d=n(0),p=n.n(d),u=(n(53),n(46)),j=(n(85),n.p+"static/media/point.ae993290.png"),m=n.p+"static/media/point2.ba3c7903.png",h=n.p+"static/media/plane.31d92501.png",b=n(2),g=n.n(b),O=g.a.icon({iconUrl:j,iconSize:[15,15]}),f=g.a.icon({iconUrl:m,iconSize:[5,5]}),x=g.a.icon({iconUrl:h,iconSize:[45,45]}),v=n(90),N=n(94),S=n(91),C=n(92),y=n(93),k=(n(86),n(1)),I=Object(u.io)("wss://tarea-3-websocket.2021-1.tallerdeintegracion.cl/",{path:"/flights"}),w=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).chatContainer=p.a.createRef(),e.state={userName:"",isLoggedIn:!1,messages:[],flights:[],positions:[],planes:[],p2:[],fp:{}},e.onButtonClicked=function(t){var n=(new Date).toString();I.emit("CHAT",{name:e.state.userName,date:n,message:t}),document.getElementById("message").value=""},e.buttonUsernameClicked=function(t){e.setState({isLoggedIn:!0,userName:t})},e.scrollToMyRef=function(){var t=e.chatContainer.current.scrollHeight-e.chatContainer.current.clientHeight;e.chatContainer.current.scrollTo(0,t)},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;I.on("connect",(function(){console.log(I.connected)})),I.emit("FLIGHTS"),I.on("FLIGHTS",(function(t){console.log(t),e.setState((function(e){return{flights:t}}));var n=[],s={},a=[],i=0;t.map((function(e){return n.push(e.origin),s[e.code]=i,a.push(i),i+=1,1})),e.setState({positions:n}),e.setState({fp:s}),e.setState({planes:a})})),I.on("POSITION",(function(t){var n=[];e.state.positions.map((function(e){return n.push(e)})),n[e.state.fp[t.code]]=t.position;var a=[].concat(Object(s.a)(e.state.p2),[t.position]);e.setState({positions:n}),e.setState({p2:a})})),I.on("CHAT",(function(t){var n=new Date(t.date).toLocaleString(),a=parseInt(n.slice(11,13)).toString(),i=n.slice(0,10).replace(/-/g,"/")+" "+a+n.slice(13,16),c=[].concat(Object(s.a)(e.state.messages),[{name:t.name,date:i,message:t.message}]);e.state.isLoggedIn?e.setState({messages:c},(function(){return e.scrollToMyRef()})):e.setState({messages:c})}))}},{key:"render",value:function(){var e=this;return Object(k.jsx)(p.a.Fragment,{children:Object(k.jsx)("div",{className:"fluid-container",children:Object(k.jsxs)("div",{className:"row",children:[Object(k.jsxs)("div",{className:"col-8",children:[Object(k.jsx)("h1",{children:"Mapa en vivo:"}),Object(k.jsx)("div",{className:"map_box",children:Object(k.jsxs)(v.a,{center:[0,0],zoom:1.4,scrollWheelZoom:!0,children:[Object(k.jsx)(N.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.state.flights.map((function(e){return Object(k.jsx)(S.a,{position:e.origin,icon:O,children:Object(k.jsx)(C.a,{smoothFactor:1,positions:[e.origin,e.destination]})})})),this.state.flights.map((function(e){return Object(k.jsx)(S.a,{position:e.destination,icon:O})})),this.state.p2.map((function(e){return Object(k.jsx)(S.a,{position:e,icon:f})})),this.state.planes.map((function(t){return Object(k.jsx)(S.a,{position:e.state.positions[t],icon:x,children:Object(k.jsxs)(y.a,{children:["Code: ",e.state.flights[t].code," ",Object(k.jsx)("br",{})]})})})),";"]})}),Object(k.jsx)("div",{className:"space"}),Object(k.jsxs)("div",{className:"flights_box",children:[Object(k.jsx)("h4",{children:"Vuelos:"}),this.state.flights.map((function(e){return Object(k.jsxs)("li",{children:["Code: ",e.code,",  Airline: ",e.airline,",  Origen: (",e.origin[0],", ",e.origin[1],"),  Destino: (",e.destination[0],", ",e.destination[1],"),  Plane: ",e.plane,", Passangers: ",e.passengers[0].name,"..."]},e.code)}))]})]}),Object(k.jsx)("div",{className:"col-4",children:Object(k.jsx)("div",{children:this.state.isLoggedIn?Object(k.jsx)("div",{children:Object(k.jsxs)("div",{className:"chat_window",children:[Object(k.jsx)("div",{className:"top_menu",children:Object(k.jsx)("div",{className:"title",children:"Centro de Control"})}),Object(k.jsx)("ul",{children:Object(k.jsx)("div",{ref:this.chatContainer,className:"Chat",children:this.state.messages.map((function(e){return Object(k.jsx)("li",{children:Object(k.jsxs)("div",{children:["(",e.date,")     ",e.name,": ",e.message]})},e.message+e.date+e.name)}))})}),Object(k.jsxs)("div",{className:"bottom_wrapper clearfix",children:[Object(k.jsx)("div",{className:"message_input_wrapper",children:Object(k.jsx)("input",{id:"message",className:"message_input",placeholder:"Escribe algo aqu\xed..."})}),Object(k.jsx)("div",{className:"send_message",children:Object(k.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:function(){return e.onButtonClicked(document.getElementById("message").value)},children:"Send"})})]})]})}):Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{children:"Reg\xedstrate para poder chatear!"}),Object(k.jsxs)("div",{className:"input-group",children:[Object(k.jsx)("input",{type:"search",id:"nickname",className:"form-control rounded",placeholder:"Nickname","aria-label":"Search","aria-describedby":"search-addon"}),Object(k.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:function(){return e.buttonUsernameClicked(document.getElementById("nickname").value)},children:"Ingresar"})]})]})})})]})})})}}]),n}(d.Component);l.a.render(Object(k.jsx)(w,{}),document.getElementById("root"))}},[[88,1,2]]]);
//# sourceMappingURL=main.fd6dd9f1.chunk.js.map